version: '3.3'

services:

  alpine-nginx:
    build: ./nginx_alpine
    container_name: alpine-nginx
    ports:
        - "80:80"
    volumes:
        - ./app/src:/var/www
        - ./nginx_alpine/nginx.conf:/etc/nginx/nginx.conf
        - ./nginx_alpine/default.conf:/etc/nginx/conf.d/default.conf
    links:
        - php

  postgres:
    container_name: postgres
    image: postgres:9.6
    ports:
        - "5432:5432"
    environment:
        - POSTGRES_DB = test
        - POSTGRES_USER = lucas
        - POSTGRES_PASSWORD = aaa

  php:
    container_name: php
    build: ./php-app
    volumes:
        - ./app/src:/var/www
        - ./php-app/www.conf:/usr/local/etc/php-fpm.d/www.conf
        - ./php-app/php.ini:/etc/php7/php.ini
    links:
        - postgres
    tty: true

#  drupal:
#    image: drupal:8.7
#    ports:
#        - 8080:80
#    volumes:
#        - /var/www/html/modules
#        - /var/www/html/profiles
#        - /var/www/html/themes
#        - /var/www/html/sites
#    restart: always
